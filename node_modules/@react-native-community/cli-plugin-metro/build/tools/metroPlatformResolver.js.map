{"version":3,"sources":["../../src/tools/metroPlatformResolver.ts"],"names":["reactNativePlatformResolver","platformImplementations","context","moduleName","platform","modifiedModuleName","startsWith","slice","length","resolveRequest"],"mappings":";;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEO,SAASA,2BAAT,CAAqCC,uBAArC,EAEJ;AACD,SAAO,CAACC,OAAD,EAAeC,UAAf,EAAmCC,QAAnC,KAAwD;AAC7D,QAAIC,kBAAkB,GAAGF,UAAzB;;AACA,QAAIF,uBAAuB,CAACG,QAAD,CAA3B,EAAuC;AACrC,UAAID,UAAU,KAAK,cAAnB,EAAmC;AACjCE,QAAAA,kBAAkB,GAAGJ,uBAAuB,CAACG,QAAD,CAA5C;AACD,OAFD,MAEO,IAAID,UAAU,CAACG,UAAX,CAAsB,eAAtB,CAAJ,EAA4C;AACjDD,QAAAA,kBAAkB,GAAI,GACpBJ,uBAAuB,CAACG,QAAD,CACxB,IAAGC,kBAAkB,CAACE,KAAnB,CAAyB,gBAAgBC,MAAzC,CAAiD,EAFrD;AAGD;AACF;;AACD,WAAON,OAAO,CAACO,cAAR,CAAuBP,OAAvB,EAAgCG,kBAAhC,EAAoDD,QAApD,CAAP;AACD,GAZD;AAaD","sourcesContent":["/**\n * This is an implementation of a metro resolveRequest option which will remap react-native imports\n * to different npm packages based on the platform requested.  This allows a single metro instance/config\n * to produce bundles for multiple out of tree platforms at a time.\n *\n * @param platformImplementations\n * A map of platform to npm package that implements that platform\n *\n * Ex:\n * {\n *    windows: 'react-native-windows'\n *    macos: 'react-native-macos'\n * }\n */\n\nexport function reactNativePlatformResolver(platformImplementations: {\n  [platform: string]: string;\n}) {\n  return (context: any, moduleName: string, platform: string) => {\n    let modifiedModuleName = moduleName;\n    if (platformImplementations[platform]) {\n      if (moduleName === 'react-native') {\n        modifiedModuleName = platformImplementations[platform];\n      } else if (moduleName.startsWith('react-native/')) {\n        modifiedModuleName = `${\n          platformImplementations[platform]\n        }/${modifiedModuleName.slice('react-native/'.length)}`;\n      }\n    }\n    return context.resolveRequest(context, modifiedModuleName, platform);\n  };\n}\n"]}